# SkyCMS Payload Optimization: Cached Config

## Before Optimization (Inline Config on Every Page)

```html
<!-- Every SkyCMS page (BAD) -->
<script src="/tailwind.js"></script>
<script>
  tailwind.config = {
    theme: {
      extend: {
        colors: { /* 50+ lines */ },
        fontFamily: { /* ... */ },
        animation: { /* ... */ },
        keyframes: { /* ... */ }
      }
    }
  };
</script>
```

**Payload per page:**
- HTML: Variable
- Inline config: ~2-3 KB per page ❌
- tailwind.js: 250 KB (cached after first load)

**Total for 10 pages:**
- First page: HTML + 3 KB config + 250 KB JS = **~253 KB + HTML**
- Next 9 pages: HTML + 3 KB config × 9 = **~27 KB extra config** ❌

---

## After Optimization (Externalized Config)

```html
<!-- Every SkyCMS page (GOOD) -->
<script src="/tailwind-config.js"></script>
<script src="/tailwind.js"></script>
```

**Payload per page:**
- HTML: Variable
- Inline config: 0 KB ✅
- External config reference: ~60 bytes

**Cache behavior:**
- tailwind-config.js: 3 KB (cached after first load) ✅
- tailwind.js: 250 KB (cached after first load) ✅

**Total for 10 pages:**
- First page: HTML + 3 KB config + 250 KB JS = **~253 KB + HTML**
- Next 9 pages: HTML only = **0 KB extra** ✅

---

## Comparison Table

| Metric | Inline Config | Cached Config | Savings |
|--------|--------------|---------------|---------|
| **First page load** | ~253 KB | ~253 KB | Same |
| **10 pages total** | ~280 KB | ~253 KB | **27 KB** |
| **100 pages total** | ~550 KB | ~253 KB | **297 KB** |
| **1000 pages total** | ~3.2 MB | ~253 KB | **~3 MB** |
| **HTML size per page** | +3 KB | +60 bytes | **2.94 KB** |

---

## Benefits of Externalized Config

### ✅ Reduced Page Size
Each HTML page is ~3 KB smaller (no inline config)

### ✅ Better Caching
Configuration loaded once, reused across all pages

### ✅ Easier Updates
Change config in one file, affects all pages instantly

### ✅ Cleaner HTML
Pages contain only content, not configuration

### ✅ Faster Subsequent Loads
Browser cache hits for both JS files

---

## File Structure

```
project/
├── tailwind-config.js       (3 KB, cached)
├── tailwind.js              (250 KB minified, cached)
├── skycms-template.html     (base template)
└── pages/
    ├── page1.html           (HTML only)
    ├── page2.html           (HTML only)
    └── page3.html           (HTML only)
```

---

## Cache Headers (Recommended)

For optimal caching, configure your server:

```nginx
# Nginx example
location ~* \.(js)$ {
  expires 1y;
  add_header Cache-Control "public, immutable";
}
```

**Result:**
- `tailwind-config.js`: Cached for 1 year
- `tailwind.js`: Cached for 1 year
- Browsers only download once per user

---

## SkyCMS Template Pattern

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }}</title>
  
  <!-- Cached config (loads once) -->
  <script src="/tailwind-config.js"></script>
  
  <!-- Cached engine (loads once) -->
  <script src="/tailwind.js"></script>
</head>
<body>
  <!-- SkyCMS generates this content -->
  {{ page.content }}
</body>
</html>
```

**Every page generated by SkyCMS:**
- Includes same 2 script tags (60 bytes each)
- No inline configuration
- Clean, minimal HTML

---

## Performance Summary

### First Visit (Cold Cache)
```
Page 1: Download 253 KB (tailwind-config.js + tailwind.js + HTML)
Page 2: Download HTML only (~5-20 KB typical)
Page 3: Download HTML only
...
```

### Returning Visit (Warm Cache)
```
All pages: Download HTML only
JavaScript files: Served from cache (0 bytes transferred)
```

---

## Bottom Line

**By externalizing the Tailwind config:**
- ✅ Each page saves ~3 KB
- ✅ Configuration cached across all pages
- ✅ Scales efficiently (1 page or 10,000 pages)
- ✅ Easier to maintain
- ✅ Production-ready pattern

**This is the optimal setup for SkyCMS with dynamic page generation.**
